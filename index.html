<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ªãch tr√¨nh H√† Giang 2025</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Google Maps JavaScript API with Places library -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&libraries=places&language=vi"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">L·ªãch tr√¨nh H√† Giang 2025</h1>
            <p class="subtitle">13-16/11/2025 ‚Ä¢ H√†nh tr√¨nh kh√°m ph√° v√πng ƒë·∫•t ƒë·ªãa ƒë·∫ßu T·ªï qu·ªëc</p>
            <div class="header-actions">
                <button class="btn-settings" id="settingsBtn" title="C√†i ƒë·∫∑t Token">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6m9-9h-6m-6 0H3"/>
                    </svg>
                    C√†i ƒë·∫∑t
                </button>
                <button class="btn-reset" id="resetBtn" title="Kh√¥i ph·ª•c d·ªØ li·ªáu ban ƒë·∫ßu">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                        <path d="M21 3v5h-5"/>
                        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                        <path d="M3 21v-5h5"/>
                    </svg>
                    Kh√¥i ph·ª•c
                </button>
                <button class="btn-overview" id="overviewBtn" title="Xem t·ªïng qu√°t chuy·∫øn ƒëi">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                        <circle cx="12" cy="10" r="3"/>
                        <path d="M12 2v3"/>
                    </svg>
                    Xem t·ªïng qu√°t
                </button>
            </div>
        </header>

        <!-- Day Tabs -->
        <div class="tabs">
            <button class="tab" data-day="all" id="viewAllBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"/>
                    <rect x="14" y="3" width="7" height="7"/>
                    <rect x="3" y="14" width="7" height="7"/>
                    <rect x="14" y="14" width="7" height="7"/>
                </svg>
                Xem t·∫•t c·∫£
            </button>
            <button class="tab active" data-day="1">Ng√†y 1 (13/11/2025)</button>
            <button class="tab" data-day="2">Ng√†y 2 (14/11/2025)</button>
            <button class="tab" data-day="3">Ng√†y 3 (15/11/2025)</button>
            <button class="tab" data-day="4">Ng√†y 4 (16/11/2025)</button>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Map Section -->
            <div class="map-section">
                <div class="map-header">
                    <div>
                        <h2 class="map-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                            B·∫£n ƒë·ªì h√†nh tr√¨nh
                        </h2>
                        <p class="map-subtitle">Xem v·ªã tr√≠ c√°c ƒëi·ªÉm ƒë·∫øn trong chuy·∫øn ƒëi - Google Maps</p>
                    </div>
                    <div class="map-actions">
                        <button class="btn-route" id="showRouteBtn">Hi·ªán tuy·∫øn ƒë∆∞·ªùng</button>
                        <button class="btn-open-maps" id="openMapsBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15 3 21 3 21 9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                            M·ªü Google Maps
                        </button>
                    </div>
                </div>
                <div class="map-container">
                    <iframe 
                        id="map" 
                        width="100%" 
                        height="100%" 
                        style="border:0; border-radius: 12px;" 
                        loading="lazy" 
                        allowfullscreen
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>

            <!-- Itinerary Section -->
            <div class="itinerary-section">
                <div class="itinerary-header">
                    <div class="itinerary-header-content">
                        <div>
                            <h2 class="itinerary-title">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2v20M2 12h20"/>
                                </svg>
                                <span id="dayTitle">Ng√†y 1 - 13/11/2025</span>
                            </h2>
                            <p class="itinerary-subtitle">Chi ti·∫øt l·ªãch tr√¨nh trong ng√†y</p>
                        </div>
                        <div class="view-toggle">
                            <button class="view-btn active" id="listViewBtn" title="Xem d·∫°ng danh s√°ch">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="8" y1="6" x2="21" y2="6"/>
                                    <line x1="8" y1="12" x2="21" y2="12"/>
                                    <line x1="8" y1="18" x2="21" y2="18"/>
                                    <line x1="3" y1="6" x2="3.01" y2="6"/>
                                    <line x1="3" y1="12" x2="3.01" y2="12"/>
                                    <line x1="3" y1="18" x2="3.01" y2="18"/>
                                </svg>
                                Danh s√°ch
                            </button>
                            <button class="view-btn" id="gridViewBtn" title="Xem d·∫°ng l∆∞·ªõi">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7"/>
                                    <rect x="14" y="3" width="7" height="7"/>
                                    <rect x="14" y="14" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/>
                                </svg>
                                L∆∞·ªõi
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Location List (for single day view) -->
                <div class="location-list" id="locationList">
                    <!-- Locations will be dynamically inserted here -->
                </div>

                <!-- Table View (for "View All" mode) -->
                <div class="table-view-container" id="tableViewContainer" style="display: none;">
                    <div class="table-wrapper">
                        <table class="itinerary-table" id="itineraryTable">
                            <!-- Table will be dynamically inserted here -->
                        </table>
                    </div>
                </div>

                <!-- Add Location Button -->
                <button class="btn-add-location" id="addLocationBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Th√™m ƒë·ªãa ƒëi·ªÉm
                </button>

                <!-- Summary -->
                <div class="summary">
                    <h3 class="summary-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        </svg>
                        T·ªïng quan h√†nh tr√¨nh
                    </h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span class="summary-label">T·ªïng qu√£ng ƒë∆∞·ªùng:</span>
                            <span class="summary-value" id="totalDistance">0 km</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Th·ªùi gian di chuy·ªÉn ∆∞·ªõc t√≠nh:</span>
                            <span class="summary-value" id="totalTime">~0 ph√∫t</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">S·ªë ƒëi·ªÉm d·ª´ng:</span>
                            <span class="summary-value" id="totalStops">0 ƒëi·ªÉm</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="instructions">
            <h3 class="instructions-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                </svg>
                H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng
            </h3>
            <div class="instructions-content">
                <p><strong>Ch·ªânh s·ª≠a th√¥ng tin:</strong></p>
                <p>Nh·∫•p v√†o bi·ªÉu t∆∞·ª£ng b√∫t ch√¨ üìù b√™n c·∫°nh m·ªói ƒë·ªãa ƒëi·ªÉm ƒë·ªÉ ch·ªânh s·ª≠a th√¥ng tin. D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c l∆∞u t·ª± ƒë·ªông trong tr√¨nh duy·ªát c·ªßa b·∫°n.</p>
                <p><strong>Th√™m ƒë·ªãa ƒëi·ªÉm:</strong></p>
                <p>Nh·∫•p v√†o n√∫t <strong>+ Th√™m ƒë·ªãa ƒëi·ªÉm</strong> ·ªü cu·ªëi m·ªói ng√†y ƒë·ªÉ th√™m m·ªôt ƒë·ªãa ƒëi·ªÉm m·ªõi v√†o l·ªãch tr√¨nh.</p>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ch·ªânh s·ª≠a th√¥ng tin ƒë·ªãa ƒëi·ªÉm</h3>
                <button class="modal-close" id="closeModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <div class="form-group">
                        <label>T√™n ƒë·ªãa ƒëi·ªÉm</label>
                        <input type="text" id="editName" required>
                    </div>
                    <div class="form-group">
                        <label>Th·ªùi gian</label>
                        <input type="text" id="editTime" placeholder="VD: 05:00 ho·∫∑c 13:30-18:30">
                    </div>
                    <div class="form-group">
                        <label>Ho·∫°t ƒë·ªông</label>
                        <textarea id="editActivities" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>B·ªØa ƒÉn</label>
                        <textarea id="editMeals" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Ch·ªó ngh·ªâ</label>
                        <input type="text" id="editAccommodation">
                    </div>
                    <div class="form-group">
                        <label>Trang ph·ª•c</label>
                        <div class="clothing-manager">
                            <div class="clothing-input-row">
                                <label for="numPeople">S·ªë ng∆∞·ªùi:</label>
                                <input type="number" id="numPeople" min="1" max="20" value="1" style="width: 80px;">
                                <button type="button" class="btn-generate-clothing" id="generateClothingBtn">T·∫°o b·∫£ng</button>
                            </div>
                            <div id="clothingTableContainer"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ghi ch√∫</label>
                        <textarea id="editNote" rows="2" placeholder="Th√™m ghi ch√∫ cho ƒë·ªãa ƒëi·ªÉm n√†y..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>üìç T√¨m ki·∫øm ƒë·ªãa ƒëi·ªÉm tr√™n Google Maps</label>
                        <input type="text" id="mapSearchInput" placeholder="Nh·∫≠p t√™n ƒë·ªãa ƒëi·ªÉm ho·∫∑c paste link Google Maps (https://maps.app.goo.gl/...)" autocomplete="off">
                        <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                            üí° <strong>C√°ch 1:</strong> Nh·∫≠p t√™n ƒë·ªãa ƒëi·ªÉm ‚Üí ch·ªçn t·ª´ danh s√°ch g·ª£i √Ω<br>
                            üí° <strong>C√°ch 2:</strong> Paste link Google Maps (Share ‚Üí Copy link) ‚Üí t·ª± ƒë·ªông l·∫•y t·ªça ƒë·ªô
                        </small>
                        <div id="searchResults" class="search-results" style="display: none;"></div>
                        <button type="button" class="btn-extract" id="selectLocationBtn" style="display: none;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                            Ch·ªçn ƒë·ªãa ƒëi·ªÉm n√†y
                        </button>
                        <div id="extractStatus" class="extract-status"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Vƒ© ƒë·ªô (Latitude)</label>
                            <input type="number" step="any" id="editLat" placeholder="T·ª± ƒë·ªông ƒëi·ªÅn khi ch·ªçn ƒë·ªãa ƒëi·ªÉm" readonly>
                        </div>
                        <div class="form-group">
                            <label>Kinh ƒë·ªô (Longitude)</label>
                            <input type="number" step="any" id="editLng" placeholder="T·ª± ƒë·ªông ƒëi·ªÅn khi ch·ªçn ƒë·ªãa ƒëi·ªÉm" readonly>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="cancelBtn">H·ªßy</button>
                        <button type="submit" class="btn-save">L∆∞u thay ƒë·ªïi</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content settings-modal">
            <div class="modal-header">
                <h3>‚öôÔ∏è C√†i ƒë·∫∑t GitHub Token</h3>
                <button class="modal-close" id="closeSettingsModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-info">
                    <p><strong>üîê GitHub Token l√† g√¨?</strong></p>
                    <p>Token cho ph√©p b·∫°n l∆∞u d·ªØ li·ªáu tr·ª±c ti·∫øp l√™n GitHub. M·ªçi ng∆∞·ªùi c√πng xem chung 1 b·ªô d·ªØ li·ªáu.</p>
                    
                    <p><strong>üìù C√°ch t·∫°o token:</strong></p>
                    <ol>
                        <li>Truy c·∫≠p: <a href="https://github.com/settings/tokens/new" target="_blank">github.com/settings/tokens/new</a></li>
                        <li>Note: <code>Ha Giang Website</code></li>
                        <li>Expiration: <code>90 days</code></li>
                        <li>Ch·ªçn quy·ªÅn: ‚úÖ <strong>repo</strong> (full control)</li>
                        <li>Click "Generate token" v√† copy</li>
                    </ol>
                    
                    <p><strong>‚ö†Ô∏è L∆∞u √Ω:</strong></p>
                    <ul>
                        <li>Token ch·ªâ hi·ªÉn th·ªã 1 l·∫ßn, h√£y l∆∞u c·∫©n th·∫≠n</li>
                        <li>Token nh·∫≠p ghp*03cFloeK2YBLMGemw4S5HJqK6yhHmP2YhWK0</li>
                        <li>Thay * th√†nh _</li>
                    </ul>
                </div>
                
                <form id="settingsForm">
                    <div class="form-group">
                        <label for="tokenInput">GitHub Token:</label>
                        <input 
                            type="password" 
                            id="tokenInput" 
                            placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"
                            autocomplete="off"
                        >
                        <button type="button" class="btn-toggle-token" id="toggleTokenBtn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="token-status" id="tokenStatus"></div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="clearTokenBtn">X√≥a Token</button>
                        <button type="submit" class="btn-save">L∆∞u Token</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Overview Modal -->
    <div class="modal" id="overviewModal">
        <div class="modal-content overview-modal">
            <div class="modal-header">
                <h3>üó∫Ô∏è T·ªïng quan chuy·∫øn ƒëi H√† Giang 2025</h3>
                <button class="modal-close" id="closeOverviewModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="overview-info">
                    <div class="overview-header-actions">
                        <h4>üìç <span id="overviewTitle">H√†nh tr√¨nh 4 ng√†y 3 ƒë√™m</span></h4>
                        <button class="btn-edit-overview" id="editOverviewBtn" title="Ch·ªânh s·ª≠a t·ªïng quan">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 20h9"/>
                                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
                            </svg>
                            Ch·ªânh s·ª≠a
                        </button>
                    </div>
                    <div class="trip-timeline" id="tripTimeline">
                        <!-- Timeline will be dynamically rendered -->
                    </div>
                </div>
                <div class="overview-map-container">
                    <h4>üó∫Ô∏è B·∫£n ƒë·ªì h√†nh tr√¨nh t·ªïng qu√°t</h4>
                    <div class="overview-map">
                        <iframe 
                            id="overviewMapIframe" 
                            width="100%" 
                            height="100%" 
                            style="border:0; border-radius: 12px;" 
                            loading="lazy" 
                            allowfullscreen
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Overview Modal -->
    <div class="modal" id="editOverviewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Ch·ªânh s·ª≠a t·ªïng quan chuy·∫øn ƒëi</h3>
                <button class="modal-close" id="closeEditOverviewModal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="editOverviewForm">
                    <div class="form-group">
                        <label>Ti√™u ƒë·ªÅ t·ªïng quan</label>
                        <input type="text" id="editOverviewTitleInput" placeholder="VD: H√†nh tr√¨nh 4 ng√†y 3 ƒë√™m">
                    </div>
                    
                    <div class="timeline-editor" id="timelineEditor">
                        <!-- Timeline items will be dynamically rendered -->
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="cancelOverviewBtn">H·ªßy</button>
                        <button type="submit" class="btn-save">L∆∞u thay ƒë·ªïi</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Check if config.js exists, if not, use localStorage token
        if (typeof GITHUB_CONFIG === 'undefined') {
            const savedToken = localStorage.getItem('githubToken') || '';
            window.GITHUB_CONFIG = {
                owner: 'vophamthanhan',
                repo: 'hagiang',
                branch: 'main',
                filePath: 'data.json',
                token: savedToken
            };
        }
    </script>
    <script src="script.js"></script>
</body>
</html>

